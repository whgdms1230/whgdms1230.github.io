---
sort: 4
---

# Abstraction

* 참고문헌 : 전문가를 위한 C++(마크 그레고리 / 한빛미디어)

## 1. 인터페이스와 구현

추상화의 핵심은 인터페이스와 구현을 실질적으로 분리하는데 있다.

구현이란 원하는 작업을 달성하기 위해 작성한 코드를 뜻하고, 인터페이스는 이렇게 작성한 코드를 다른 이들이 사용하기 위한 수단이다.

OOP에서 인터페이스는 외부에서 접근할 수 있는 클래스의 프로퍼티와 메서드로 구성된다. 잘 정의한 인터페이스는 public 메서드만 가지고 있다. 클래스의 프로퍼티는 절대로 공개하면 안되고, 게터와 세터라 부르는 public 메서드를 통해서 접근하도록 구성해야 한다.

## 2. 외부에 공개할 인터페이스 결정하기

클래스를 디자인할 때는 다른 프로그래머가 이 클래스의 객체를 접근하는 방법도 정해야 한다.

C++에서는 클래스의 프로퍼티와 메서드를 public, protected, private 중 하나로 지정할 수 있다. 

* public : 다른 코드에서 접근 가능
* protected : 이 클래스를 상속한 파생 클래스만 접근 가능
* private : 접근 불가

결국 인터페이스를 외부에 공개하는 방식은 어떤 항목을 public으로 지정하는 가에 따라 결정된다.

### 2.1 사용자 고려하기
인터페이스의 사용법을 물어볼 사람이 누군지 생각해보면 디자인의 주안점을 어디에 둘지 파악하기 쉽다.

개인적으로만 사용한다면 디자인을 여러 차례 변경해도 문제없다. 인터페이스를 사용하다가 입맛에 맞게 얼마든지 수정하면 된다.

만약 다른 프로그래머가 사용할 인터페이스를 디자인 할 때는 다른 이들이 필요로 하는 기능을 모두 반영하도록 구현해야 한다. 버전 관리가 필요한지, 저장하는 데이터의 타입으로 어떤 것이 있는지 등을 고려해야 한다. 또한 인터페이스를 마음대로 변경할 수도 없다. 코드를 시작하기 전 정해둔 인터페이스와 동일하게 구현해야 한다.

만약 외부 고객이 사용한다면, 고객에 원하는 구체적인 기능뿐만 아니라 향후에 필요할 가능성이 있는 부분도 함께 고려해야 한다. 인터페이스에 사용되는 용어도 고객에 익숙한 표현으로 정한다.

### 2.2 용도 고려하기
인터페이스를 작성하는 목적은 다양하다. 코드를 문서화하거나 외부에 노출할 기능을 결정하기 전에 먼저 인터페이스의 용도를 파악해야 한다.

#### 2.2.1 API
API는 제품의 기능을 다양한 용도로 활용하거나 그 제품의 기능을 확장하기 위해 외부에 제공하는 인터페이스다.

API를 제공하기 시작하면, 특별히 도움 되는 기능이 새로 추가되지 않는 한 변경하지 않는 것이 좋다. 따라서 API를 결정하기 전에 신중하게 디자인하고 고객이 원하는 바를 최대한 반영하도록 여러 의견을 충분히 수렴해야 한다.

API를 디자인할 때 가장 고민해야 할 사항은 사용성과 유연성의 절충점을 찾는 것이다. API의 사용법을 쉽게 익히도록 구성하면서 복잡한 기능도 사용할 수 있도록 해야한다.

#### 2.2.2 유틸리티 클래스 또는 라이브러리
특정한 기능을 애플리케이션에서 범용적으로 사용할 수 있도록 만들어야 할 때 사용된다. 가장 핵심적인 사항은 범용성이다. 클래스나 라이브러리는 다양한 문맥에서 사용하기 때문에 구체적인 활용 범위를 최대한 고려해서 디자인에 반영해야 한다.

#### 2.2.3 서브시스템 인터페이스
데이터베이스 접근 메커니즘과 같이 애플리케이션을 구성하는 주요 서브시스템끼리 서로 연동하는 인터페이스를 디자인해야 할 때도 있다. 이때 인터페이스와 구현을 명확히 분리하는 것이 무엇보다도 중요하다.

서브시스템을 다룰 때 가장 먼저 고려할 점은 그 서브시스템의 핵심 목적을 분명히 하는 것이다. 구체적인 활용 사례를 따져보고 다른 이들에게 어떤 형태로 제공돼야 할지 결정한다. 이때 상대방의 입장에서 바라보고, 구현의 세부사항에 너무 빠지지 않도록 주의한다.

#### 2.2.4 컴포넌트 인터페이스
서브시스템 인터페이스나 API보다는 규모가 작은 인터페이스를 정의하는 경우로, 작성한 다른 코드에서 사용할 클래스가 해당한다. 혼자서만 사용하는 인터페이스더라도 다른 이들이 사용한다는 생각으로 디자인해야 한다. 서브시스템과 마찬가지로 각 클래스의 주 목적을 염두에 두고 이에 벗어난 기능을 외부에 노출하지 않도록 주의한다.

### 2.3 미래 고려하기
지금 디자인한 인터페이스를 향후 몇 년 동안 변경할 수 없다면 확장성을 제공하도록 플러그인 아키텍처를 도입할 필요하 있다. 또는 본래 의도와 다른 용도로 인터페이스가 활용될 가능성도 고려한다.

## 3. 바람직한 추상화 디자인
추상화를 잘 하기 위해서는 다양한 경험이 필수다. 완벽한 인터페이스는 수년간 다양한 방식으로 추상화하고 구현한 경험의 결과로 나오는 것이다.

추상화가 잘된 인터페이스는 public 메서드로만 구성된다. 모든 코드는 구현 파일에 있고 클래스 정의 파일에는 없어야 한다. 다시 말해 클래스 정의가 있는 인터페이스 파일은 변경할 일이 없어야 한다.

클래스 하나만으로 추상화 할 때는 각별히 주의한다. 작성하는 코드의 계층 구조가 너무 깊다면 주 인터페이스를 보조할 다른 클래스를 도입하는 것이 좋다.

프로퍼티는 모두 메서드로 변환한다. 외부 코드에서 클래스에 직접 접근해서 데이터를 조작하면 안 된다.